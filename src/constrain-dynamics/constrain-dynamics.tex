\input{../include/preample-jsarticle}
\input{../include/page-rayout}
\input{../include/usepackage}
\input{../include/macro}
\input{../include/begin}

\title{拘束条件付き分子動力学法}
\maketitle

分子動力学シミュレーションでは, しばしば, 水分子のO原子とH原子の距離を固定して剛体として取り扱ったり, 水素原子など軽い原子の伸縮を平衡距離に拘束することで, 時間刻みを長く設定し, 長時間のシミュレーションを実現したりする. 
あるいは温度や圧力を制御するために, 運動量や瞬間圧力を課す.
本章では拘束条件を満たしながら運動方程式の数値積分を実行するためのアルゴリズムを説明する. 

拘束条件として時間に依存しないホロノミックな拘束条件
\begin{equation}
    \sigma_{k} (\bm{r}_{1},\cdots, \bm{r}_{N}) = 0
\end{equation}
を考えた時, デカルト座標でのラグランジュの運動方程式と微分形式の拘束条件はそれぞれ
\begin{equation}
    \frac{d}{dt} \left(\frac{\partial \mathcal{L}}{\partial \dot{\bm{r}}_{i}} \right) -\frac{\partial \mathcal{L}}{\partial \bm{r}_{i}} = \sum_{k=1}^{N_{\mathrm{c}}} \lambda_{k} \bm{a}_{ki},
\end{equation}

\begin{equation}
    \sum_{i=1}^{N} \bm{a}_{ki} \cdot \dot{\bm{r}}_{i} = 0
    \label{Eq:constrain-eq}
\end{equation}
である. 
ここで$\lambda_{k}$はラグランジュの未定乗数である. また, 拘束条件の中の係数は
\begin{equation}
    \bm{a}_{ki} = \nabla_{i} \sigma_{k} (\bm{r}_{1}, \cdots, \bm{r}_{N})
    \label{Eq:constrain-eq-position}
\end{equation}
であり, これは座標に関する拘束条件に関連している. 
ラグランジアンが$\mathcal{L}=\sum_{i=1}^{N} \dot{\bm{r}}_{i}^{2}/(2m_{i}) + U(\bm{r})$で記述されるとすると, ラグランジュの運動方程式と拘束条件は
\begin{equation}
    m_{i} \ddot{\bm{r}}_{i}
    =
    \bm{F}_{i} + \sum_{k=1}^{N_{\mathrm{c}}} \lambda_{k} \nabla_{i} \sigma_{k}
    \label{eq:eom-constrain}
\end{equation}

\begin{equation}
    \frac{d}{dt} \sigma_{k} (\bm{r}_{1},\cdots, \bm{r}_{N}) = 0
    \label{Eq:timederiv-constrain-eq}
\end{equation}
と等価であることが確認できる. 拘束条件付き運動方程式(\ref{eq:eom-constrain})の右辺二項目$\sum_{k=1}^{N_{\mathrm{c}}} \lambda_{k} \nabla_{i} \sigma_{k}$は拘束条件に由来する力であり, 拘束力$\bm{F}_{\mathrm{c}}$と呼ばれる. つまり, 粒子$i$の速度は原子・分子間力に加え, 拘束に由来する力によって変化することを意味している. 
式(\ref{Eq:timederiv-constrain-eq})は拘束条件の時間に関する全微分で, 拘束条件は時間発展に大して不変であることを意味する. 

以下では, まず初めにホロノミックな拘束の具体例を紹介する. 
続いて, 拘束条件を満たしながら時間発展を記述するためのアルゴリズムを述べる. 
拘束条件付き運動方程式(\ref{eq:eom-constrain})を数値積分するには, 時刻$t$で満たしていた拘束が時刻$t + \Delta t$でも満たすように未定乗数$\lambda_{k}$を決定していく必要がある. 
一般に拘束条件は未定乗数$\lambda_{k}$に関する非線形連立方程式の形で書かれ, その解法は大きく二つに分類される. 
一つは, 未定乗数$\lambda_{k}$に関する非線形連立方程式を行列方程式の形に直し, 逆行列を作用させることで$\lambda_{k}$を直接求める方法である. 
もう一つは非線形連立方程式の近似式から未定乗数$\gamma_{k}$を推定し, 反復法によって未定乗数$\gamma_{k}$が必要な精度になるまで未定時乗数の見積もりを繰り返す方法である. 
二つ目の方法の代表的なアルゴリズムとしてSHAKE法\cite{1977Ryckaert}やRATTLE法\cite{1980Andersen}が挙げられる. 


\section{ホロノミックな拘束条件の具体的な例}
\subsection{二粒子間の距離に対する拘束の式}
二粒子間の距離の拘束条件は

\begin{equation}
    \sigma(t)  \equiv [\bm{r}_{i}(t) - \bm{r}_{j}(t)]^{2} - d_{ij}^2 = 0
    \label{Eq:distance-constrain}
\end{equation}
とかける. $d_{ij}$は原子$i$と原子$j$の間の距離である. 拘束力は, 
\begin{equation}
    \frac{d\sigma(t)}{d\bm{r}_{i}} =
    \begin{cases}
        2 \left[ \bm{r}_{i}(t) - \bm{r}_{j} (t) \right], ~~~&\mathrm{(拘束に原子}i\mathrm{が関与している時)} \\
        0 ~~~&\mathrm{(それ以外)}
    \end{cases}
\end{equation}
と計算される. 
一方, 拘束条件(\ref{Eq:distance-constrain})に対して時間微分すると
\begin{equation}
    \frac{d\sigma(t)}{dt} =
    \left[\bm{r}_{i}(t) - \bm{r}_{j} (t)\right] \cdot
    \left[\dot{\bm{r}}_{i}(t) - \dot{\bm{r}}_{j} (t)\right]
\end{equation}
を得る. これは相対速度が位置ベクトルの差に直交することを意味し, 拘束力は仕事しないことが分かる. 

%\subsection{角度に対する拘束の式}

\section{座標に対する拘束動力学: ベルレ法による時間発展とSHAKE法}
拘束条件を含む場合, ベルレ法を用いた時間発展は
\begin{equation}
    \bm{r}_{i} (t + \Delta t) = 2 \bm{r}_{i} (t) - \bm{r}_{i} (t - \Delta t) + \frac{1}{m_{i}}\left[ \bm{F}_{i}(t) + \sum_{k=1}^{N_{\mathrm{c}}} \lambda_{k} \nabla_{i} \sigma_{k}(t) \right] (\Delta t)^{2}
\end{equation}
となる. 
ここで元々の分子間ポテンシャルによる座標の時間発展を
\begin{equation}
    \bm{r}_{i}^{\prime} (t + \Delta t) = 2 \bm{r}_{i} (t) - \bm{r}_{i} (t - \Delta t) +  \frac{\bm{F}_{i}(t)}{m_{i}}  (\Delta t)^{2}
\end{equation}
とおき, 拘束力による座標補正について$\gamma_{k} = \lambda_{k}(\Delta t)^{2}$を用いて
\begin{equation}
    \Delta \bm{r}_{i}(t + \Delta t) = \frac{1}{m_{i}} \sum_{k=1}^{N_{\mathrm{c}}} \gamma_{k} \nabla_{i} \sigma_{k}(t)
\end{equation}
とおくと, ベルレ法による拘束条件付きの時間発展は
\begin{align}
    \bm{r}_{i} (t + \Delta t)
    &= \bm{r}_{i}^{\prime} (t + \Delta t) + \frac{1}{m_{i}} \sum_{k=1}^{N_{\mathrm{c}}} \gamma_{k} \nabla_{i} \sigma_{k}(t)
    \\
    &= \bm{r}_{i}^{\prime} (t + \Delta t) + \Delta \bm{r}_{i}(t + \Delta t)
\end{align}
と書くことができる. 
時刻$t$で満たしていた拘束条件が時刻$t + \Delta t$でも満たすように未定乗数$\lambda_{k}$を決定する必要がある. 
つまり, 各拘束条件$\sigma_{k} (\bm{r}_{1}, \cdots, \bm{r}_{N})=0$は時刻$t + \Delta t$でも成立するので, 

\begin{equation}
    \sigma_{k} (\bm{r}_{1}(t + \Delta t), \cdots, \bm{r}_{N}(t + \Delta t)) = 0
\end{equation}
が成り立つ. $\bm{r}_{i} (t + \Delta t)$を具体的に代入すると, 
\begin{equation}
    \sigma_{k} \left( \bm{r}_{1}^{\prime} (t + \Delta t) + \frac{1}{m_{1}} \sum_{k=1}^{N_{\mathrm{c}}} \gamma_{k} \nabla_{1} \sigma_{k}(t), \cdots, \bm{r}_{N}^{\prime} (t + \Delta t) + \frac{1}{m_{N}} \sum_{k=1}^{N_{\mathrm{c}}} \gamma_{k} \nabla_{N} \sigma_{k}(t) \right) = 0
\end{equation}
を得る. 
これは, $N_{\mathrm{c}}$個の未定乗数$\gamma_{k}$に対する$N_{\mathrm{c}}$個の非線形方程式である. 
この方程式を解いて$\gamma_{k}$を得ることができれば, 拘束条件を満たすように座標を更新することができる. 
拘束の式が単純な形式であれば代数的に$\gamma_{k}$を求めることができるが, そうでない場合は, 反復的に方程式を解いて$\gamma_{k}$を求める必要がある. 
反復的に解く方法として\textbf{SHAKE法}\cite{1977Ryckaert}がよく用いられる. 


\subsection{未定乗数$\gamma_{k}$が代数的に求まる例: 距離の拘束が単独で存在する場合}

距離の拘束が単独で存在する場合, 拘束に関する未定乗数が代数的に求められる. 
例えば, 原子$i$と原子$j$には距離の拘束$d_{ij}$のみが課せられており, その他の拘束が存在しない場合を考える:
\begin{equation}
    \sigma(t)  \equiv [\bm{r}_{i}(t) - \bm{r}_{j}(t)]^{2} - d_{ij}^2 = 0.
\end{equation}
時刻$t + \Delta t$における拘束条件は
\begin{align}
    \sigma（t＋\Delta t)
    &=
    \left[ \bm{r}_{i} (t + \Delta t) - \bm{r}_{i} (t + \Delta t) \right]^{2}
    - d_{ij}^{2}
    \\ \notag
    &=
    \left\{
        \left[
            \bm{r}_{i}^{\prime}(t + \Delta t) + \Delta \bm{r}_{i}(t + \Delta)
        \right]
        -
        \left[
            \bm{r}_{j}^{\prime}(t + \Delta t) + \Delta \bm{r}_{j}(t + \Delta t)
        \right]
    \right\}^{2} - d_{ij}^{2}
    = 0
    \label{eq:dist-constrain-delt}
\end{align}
である. 
拘束力による座標補正は具体的に
\begin{alignat}{5}
\Delta \bm{r}_{i}(t + \Delta t)
&=   \frac{\gamma}{m_{i}}\nabla_{i} \sigma(t)
&&= &\frac{2\gamma}{m_{i}} \left[ \bm{r}_{i}(t) - \bm{r}_{j}(t) \right]
&= &&\frac{\tilde{\gamma}}{m_{i}} \left[ \bm{r}_{i}(t) - \bm{r}_{j}(t) \right]
\\
\Delta \bm{r}_{j}(t + \Delta t)
&=    \frac{\gamma}{m_{j}}\nabla_{j} \sigma(t)
&&= -&\frac{2\gamma}{m_{j}} \left[ \bm{r}_{i}(t) - \bm{r}_{j}(t) \right]
&= -&&\frac{\tilde{\gamma}}{m_{j}} \left[ \bm{r}_{i}(t) - \bm{r}_{j}(t) \right]
\end{alignat}
と計算される. 
ここで未定乗数を$\tilde\gamma \equiv 2\gamma$と置き直した. 
これらを拘束条件式(\ref{eq:dist-constrain-delt})に代入すると$\tilde\gamma$に関する二次方程式
\begin{align}
    &\left[
        \left(\frac{1}{m_{i}} + \frac{1}{m_{j}} \right)
        \left[\bm{r}_{i}(t) - \bm{r}_{j}(t)\right]
    \right]^{2} \tilde{\gamma}^{2}
    \\ \notag
    +
    &\left\{
        2\left(\frac{1}{m_{i}} + \frac{1}{m_{j}} \right)
        \left[
            \bm{r}_{i}(t) - \bm{r}_{j}(t)
        \right]
        \cdot
        \left[
            \bm{r}_{i}^{\prime}(t + \Delta t) - \bm{r}_{j}^{\prime}(t + \Delta t)
        \right]
    \right\} \tilde{\gamma}
    \\ \notag
    +
    &\left[
        \bm{r}_{i}^{\prime}(t + \Delta t) - \bm{r}_{j}^{\prime}(t + \Delta t)
    \right]^{2}
    - d_{ij}^{2} = 0
\end{align}
が得られ, 代数的に未定乗数が求まる. 


\subsection{未定乗数$\gamma_{k}$の反復的解法: SHAKEアルゴリズム\cite{1977Ryckaert}}
原子$i$に対して拘束が複数存在するなど拘束条件が干渉しあって複雑な場合や, 数値積分法よりも高精度な解が必要な場合は反復法によって未定乗数を決定する. このような反復法のことをSHAKE法と呼ぶ. 
SHAKE法の基本的なアルゴリズムは以下の通りである:
\begin{enumerate}
    \item 系に一番目の拘束力だけが働いているとして$\gamma_{1}$を求め, 一番目の拘束条件が満足するように, 一番目の拘束に関与している粒子の座標を補正する. 
    \item 一番目の拘束を満足している新たな座標を$\bm{r}_{i}^{\prime}(t + \Delta t)$と置き直し, 次に二番目の拘束力だけが働いているとして$\gamma_{2}$を求めて, 二番目の拘束条件が満足するように, 二番目の拘束に関与している粒子の座標を補正する. 
    \item 三番目, 四番目,,,,$N_{\mathrm{c}}$番目の拘束についても同様に, その拘束力だけ働いているとして$\gamma_{k}$を求め, その拘束条件が満足するように, 拘束に関与している粒子の座標補正を繰り返す. 
    \item 手順1--3を繰り返し, 全ての拘束が十分な精度で満たされるまで座標の補正操作を繰り返す. 
\end{enumerate}

二粒子間の距離拘束のように, 未定乗数$\gamma_{k}$が代数的に求まる場合は, 以上の手順で座標補正を繰り返し実行すれば良い. 
しかし, 一般に$\gamma_{k}$は非線形連立方程式を解く必要がある. 拘束の数が多い場合や拘束が互いに干渉している場合など, 拘束が複雑な場合は$\gamma_{k}$の求め方自体が問題となる. 
このような場合は, 非線形連立方程式の近似式から$\gamma_{k}$を推定し, 拘束条件が満たされるまで, $\gamma_{k}$の推定と座標補正を繰り返す. 
具体的には, もし前ステップで得られた未定乗数など, 未定乗数の初期推定値$\{\gamma_{k}^{(1)}\}$が利用可能である場合, この推定値を用いて座標を次のように更新する:
\begin{equation}
    \bm{r}_{i}^{(1)} =
    \bm{r}_{i}^{\prime} + \frac{1}{m_{i}} \sum_{k=1}^{N_{\mathrm{c}}} \gamma_{k}^{(1)} \nabla_{i} \sigma_{k}(t)
\end{equation}
未定乗数の厳密な解$\gamma_{k}$は推定値$\gamma_{k}^{(1)}$と厳密解からのずれ$\delta \gamma_{k}^{(1)}$を用いて, 
\begin{equation}
    \gamma_{k} = \gamma_{k}^{(1)} + \delta \gamma_{k}^{(1)}
\end{equation}
とおくと, 時刻$t + \Delta t$での座標は
\begin{equation}
    \bm{r}_{i} (t + \Delta t) =
    \bm{r}_{i}^{\prime} + \frac{1}{m_{i}} \sum_{k=1}^{N_{\mathrm{c}}} \delta \gamma_{k}^{(1)} \nabla_{i} \sigma_{k}(t)
\end{equation}
であるので, 拘束条件は, 
\begin{equation}
    \sigma_{k} \left( \bm{r}_{1}^{(1)} + \frac{1}{m_{1}} \sum_{k=1}^{N_{\mathrm{c}}} \delta \gamma_{k} \nabla_{1} \sigma_{k}(t), \cdots, \bm{r}_{N}^{(1)} + \frac{1}{m_{N}} \sum_{k=1}^{N_{\mathrm{c}}} \delta \gamma_{k} \nabla_{N} \sigma_{k}(t) \right) = 0
\end{equation}
とかかれる. 
次に, この拘束条件を$\delta \gamma_{k}^{(1)} = 0$の周りで, 一次までの多変数テイラー展開を実行する:
\begin{align}
    \sigma_{l}(\bm{r}_{1}^{1}, \cdots, \bm{r}_{N}^{(1)}) +
    \sum_{i=1}^{N} \sum_{k=1}^{N_{\mathrm{c}}} \frac{1}{m_{i}}
    \nabla_{i} \sigma_{l} (\bm{r}_{1}^{1}, \cdots, \bm{r}_{N}^{(1)}) \cdot
    \nabla_{i} \sigma_{k} (\bm{r}_{1}^{1}(t), \cdots, \bm{r}_{N}^{(1)}(t))
    \delta \gamma_{k}^{(1)}
    \simeq 0 ~~~~ (l = 1,\cdots,N_{\mathrm{c}})
\end{align}
便利のため
\begin{equation}
A_{lk} \equiv \sum_{i=1}^{N}\frac{1}{m_{i}}\nabla_{i} \sigma_{l} (\bm{r}_{1}^{1}, \cdots, \bm{r}_{N}^{(1)}) \cdot \nabla_{i} \sigma_{k} (\bm{r}_{1}^{1}(t), \cdots, \bm{r}_{N}^{(1)}(t))
\end{equation}
を定義すると
\begin{equation}
    \sigma_{l}(\bm{r}_{1}^{1}, \cdots, \bm{r}_{N}^{(1)}) + \sum_{k=1}^{N_{\mathrm{c}}} A_{lk}  \delta \gamma_{k}^{(1)} \simeq 0, ~~~~ (l = 1,\cdots,N_{\mathrm{c}})
    \label{Eq:mshake-equtation}
\end{equation}
となる. 
この式は行列方程式であることが分かる. 
この方程式の次元が大きくない場合は, 逆行列を作用させることで直ちに$\delta \gamma_{k}^{(1)}$が求まる. 
この方法はmatrix-SHAKEあるいはM-SHAKEと呼ばれる\cite{2001Krautler}. 
しかしながら, この方程式は線形近似であるため, 得られた$\gamma_{k}^{(1)}$を用いて座標を補正しても, 拘束条件を満たした座標$\bm{r}_{i}(t + \Delta t)$に一致するとは限らない. 
そのため, 次に
\begin{equation}
    \bm{r}_{i}^{(2)} =
    \bm{r}_{i}^{(1)} + \frac{1}{m_{i}} \sum_{k=1}^{N_{\mathrm{c}}} \delta \gamma_{k}^{(1)} \nabla_{i} \sigma_{k}(t)
\end{equation}
\begin{equation}
    \bm{r}_{i} (t + \Delta t) =
    \bm{r}_{i}^{(2)} + \frac{1}{m_{i}} \sum_{k=1}^{N_{\mathrm{c}}} \delta \gamma_{k}^{(2)} \nabla_{i} \sigma_{k}(t)
\end{equation}
を定義し, $\gamma_{k}^{(1)}$を求めたのと同様の手順で$\gamma_{k}^{(2)}$を求めて座標を補正する. 
この手順を拘束条件が満たされるまで繰り返す. 

課せられている拘束条件の数が多く, 行列方程式の次元が大きい場合, 計算時間を節約するために, さらに近似を進めることも可能である. 
行列方程式(\ref{Eq:mshake-equtation})の対角成分だけを考えると
\begin{equation}
    \sigma_{l}(\bm{r}_{1}^{1}, \cdots, \bm{r}_{N}^{(1)}) +
    \sum_{i=1}^{N}  \frac{1}{m_{i}}
    \nabla_{i} \sigma_{l} (\bm{r}_{1}^{1}, \cdots, \bm{r}_{N}^{(1)}) \cdot
    \nabla_{i} \sigma_{l} (\bm{r}_{1}^{1}(t), \cdots, \bm{r}_{N}^{(1)}(t))
    \delta \gamma_{l}^{(1)}
    \simeq 0, ~~~~ (l = 1,\cdots,N_{\mathrm{c}})
\end{equation}
のように一次方程式に近似され, 未定乗数からの差分は
\begin{equation}
    \delta \gamma_{l}^{(1)} =
    \frac{\sigma_{l} (\bm{r}_{1}^{1}, \cdots, \bm{r}_{N}^{(1)})}{\sum_{i=1}^{N} \frac{1}{m_{i}} \nabla_{i} \sigma_{l} (\bm{r}_{(1)}^{1}, \cdots, \bm{r}_{N}^{(1)}) \cdot \nabla_{i} \sigma_{l} (\bm{r}_{1}^{(1)}(t), \cdots, \bm{r}_{N}^{(1)}(t))}
    ,~~~~
    (l = 1,\cdots,N_{\mathrm{c}})
\end{equation}
と計算される. 

%\subsection{水分子への応用例}

\section{速度と座標に対する拘束動力学: 速度ベルレ法による時間発展とRATTLE法}
前節で紹介したSHAKE法では, 拘束の式(\ref{Eq:constrain-eq})の座標部分(\ref{Eq:constrain-eq-position})を満たすが, 速度の拘束条件については満たしていない. 
ベルレ法は座標の更新のみで時間発展を記述するためSHAKE法で十分であったが, 時間発展に速度が含まれる場合, 速度の拘束も考慮する必要がある. 
例えば, 速度ベルレ法では
\begin{alignat}{2}
    &\bm{v}_{i} \left( t + \frac{\Delta t}{2} \right)
    &&= \bm{v}_{i} (t)
     + \frac{\bm{F}_{i} (t) }{2m_{i}} \Delta t
    \label{Eq:vel-verlet-vhalf}
    \\
    &\bm{r}_{i} (t + \Delta t)
    &&= \bm{r}_{i} (t)
      + \bm{v}_{i} \left( t + \frac{\Delta t}{2} \right)\Delta t
    \label{Eq:vel-verlet-r}
    \\
    &\bm{v}_{i} \left( t + \Delta t \right)
    &&= \bm{v}_{i} \left(t + \frac{\Delta t}{2} \right)
     + \frac{\bm{F}_{i} (t + \Delta t) }{2m_{i}} \Delta t
    \label{Eq:vel-verlet-v}
\end{alignat}
のように座標と速度によって時間発展が記述される. 
アンダーセンの方法による定圧分子動力学法\cite{1980Andersen}を初めとする拡張系の分子動力学法では, 速度が変数として扱われており, その時間発展アルゴリズムも速度ベルレ法に基づいている. 
このような場合, 座標の拘束に加えて, 速度についても拘束条件の式(\ref{Eq:constrain-eq})を満たさなければならない. 
このように速度ベルレ法と結びついた拘束動力学法をRATTLE法\cite{1983Andersen}という. 

まずは拘束力を考慮した時の座標の時間発展を考える:
\begin{align}
    \bm{r}_{i} (t + \Delta t)
    =&
    \bm{r}_{i} (t)
    +
    \bm{v}_{i} (t) \Delta t + \frac{(\Delta t)^{2}}{2m_{i}} \bm{F}_{i}(t)
    +
    \frac{(\Delta t^{2})}{2m_{i}}
    \sum_{k=1}^{N_{\mathrm{c}}} \lambda_{k} \nabla_{i} \sigma_{k}(t)
    \\
    =&
    \bm{r}_{i}^{\prime} (t + \Delta t)
    +
    \frac{1}{m_{i}} \sum_{k=1}^{N_{\mathrm{c}}} \gamma_{k} \nabla_{i} \sigma_{k}(t)
    \\
    =&
    \bm{r}_{i}^{\prime} (t + \Delta t)
    +
    \Delta \bm{r}_{i} (t + \Delta t)
\end{align}
ここで, 未定乗数を$\gamma_{k} = (\Delta t^{2}/2)\lambda_{k}$, 拘束力による座標補正を$\Delta \bm{r}_{i}$とおいた. 
上付きの$\prime$は分子間ポテンシャルのみ考慮した場合の時間発展であることを示す. 
このように書き直すと, 拘束条件付き運動方程式をベルレ法を用いて数値積分した時と同じような定式化であることに気づく. 
したがって, 座標に関する拘束条件を満たすにはSHAKE法を用いればよい. 

続いて, 速度の時間発展を考える. 
全ての未定乗数が十分な精度で得られていて, 座標は既に全ての拘束条件を満たすように補正されているとすると, 時刻$t+\Delta t/2$における速度は
\begin{equation}
    \bm{v}_{i} \left(t + \frac{\Delta t}{2} \right)
    =
    \bm{v}_{i} (t)
    +
    \frac{\Delta t}{2m_{i}} \bm{F}_{i} (t)
    +
    \frac{1}{m_{i} \Delta t}
    \sum_{k=1}^{N_{\mathrm{c}}} \gamma_{k} \nabla_{i} \sigma_{k}(t)
\end{equation}
にしたがって更新される. 
時刻$t+\Delta t$では拘束の式(\ref{Eq:constrain-eq})を満たすように速度を更新することを考える. 
座標の更新によって, 時刻$t+\Delta t$における力が得られると, 速度は
\begin{align}
    \bm{v}_{i} (t + \Delta t)
    =&
    \bm{v}_{i} \left(t + \frac{\Delta t}{2}\right)
    +
    \frac{\Delta t}{2m_{i}} \bm{F}_{i}(t + \Delta t)
    +
    \frac{\Delta t}{2m_{i}}
    \sum_{k=1}^{N_\mathrm{c}} \mu_{k} \nabla_{i} \sigma_{k}(t + \Delta t)
    \\
    =&
    \bm{v}_{i}^{\prime} (t + \Delta t)
    +
    \frac{1}{m_{i}}
    \sum_{k=1}^{N_\mathrm{c}} \xi_{k} \nabla_{i} \sigma_{k}(t + \Delta t)
    \label{Eq:v-update-rattle}
\end{align}
とかける. 
ここで, 速度更新に付随する課せられる拘束条件の未定乗数を$\mu_{k}$とおき, 座標更新の際に使った未定乗数$\lambda_{k}$と区別した. 
また, 第１式から第２式への変形で未定乗数を$\xi_{k} = (\Delta t/2)\mu_{k}$と置き直した. 
未定乗数$\xi_{k}$は, 拘束の式(\ref{Eq:constrain-eq})について
\begin{equation}
    \sum_{i=1}^{N} \nabla_{i}\sigma_{k} (t + \Delta t)
    \cdot
    \bm{v}_{i} (t + \Delta t)
    = 0
\end{equation}
を解くことで得られる. 
具体的に速度$\bm{v}_{i}(t + \Delta t)$を代入すると, $\xi_{k}$に関する$N_{\mathrm{c}}$個の線形連立方程式
\begin{equation}
    \sum_{i=1}^{N} \nabla_{i}\sigma_{k} (t + \Delta t)
    \cdot
    \left[
        \bm{v}_{i}^{\prime} (t + \Delta t)
        +
        \frac{1}{m_{i}}
        \sum_{k=1}^{N_\mathrm{c}} \xi_{k} \nabla_{i} \sigma_{k}(t + \Delta t)
    \right]
    = 0
    \label{Eq:simeq-vel-constrain-multipliers}
\end{equation}
を得る. 
この連立方程式に関して逆行列を求めることで, 直ちに$\xi_{k}$を得ることができる. 
もし拘束の数が多く逆行列の計算コストが高い場合や, 拘束が互いに干渉している場合には, SHAKE法のように反復的に未定乗数$\xi_{k}$を求める. 
未定乗数$\xi_{k}$が十分収束したら, 式(\ref{Eq:v-update-rattle})を用いて速度を更新する. 


\subsection{未定乗数$\xi_{k}$の計算例: 距離の拘束が単独で存在する場合}

速度束縛に関する未定乗数$\xi_{k}$の計算例として, 原子$i$と原子$j$には距離の拘束$d_{ij}$のみが課せられており, その他の拘束が存在しない場合を考える:
\begin{equation}
    \sigma(t)  \equiv [\bm{r}_{i}(t) - \bm{r}_{j}(t)]^{2} - d_{ij}^2 = 0.
\end{equation}
連立方程式(\ref{Eq:simeq-vel-constrain-multipliers})を具体的に計算すると, 
\begin{alignat}{2}
    &\nabla_{i} \sigma(t + \Delta t)
    =
    &&2\left[\bm{r}_{i}(t + \Delta t) - \bm{r}_{j} (t + \Delta t)\right]
    \\
    &\nabla_{j} \sigma(t + \Delta t)
    =
    -&&2\left[\bm{r}_{i}(t + \Delta t) - \bm{r}_{j} (t + \Delta t)\right]
\end{alignat}
であり, 各原子の速度は
\begin{align}
    \bm{v}_{i} (t + \Delta t)
    &=
    \bm{v}_{i}^{\prime} (t + \Delta t)
    +
    \frac{2\xi}{m_{i}}
    \left[\bm{r}_{i}(t + \Delta t) - \bm{r}_{j} (t + \Delta t)\right]
    \\
    \bm{v}_{j} (t + \Delta t)
    &=
    \bm{v}_{j}^{\prime} (t + \Delta t)
    -
    \frac{2\xi}{m_{j}}
    \left[\bm{r}_{i}(t + \Delta t) - \bm{r}_{j} (t + \Delta t)\right]
\end{align}
と計算される. 数式の見やすさのために
\begin{align}
    \bm{r}_{ji} (t + \Delta t)
    &=
    \bm{r}_{i}(t + \Delta t) - \bm{r}_{j} (t + \Delta t)
    \\
    \bm{v}_{ji}^{\prime} (t + \Delta t)
    &=
    \bm{v}_{i}^{\prime} (t + \Delta t) - \bm{v}_{j}^{\prime} (t + \Delta t)
\end{align}
とおくと, 連立方程式(\ref{Eq:simeq-vel-constrain-multipliers})は
\begin{alignat}{2}
    &2\bm{r}_{ji} (t + \Delta t) \cdot
    \left[
        \bm{v}_{i}^{\prime} (t + \Delta t)
        +
        \frac{2\xi}{m_{i}} \bm{r}_{ji} (t + \Delta t)
    \right]
    &&=0
    \\
    -&2\bm{r}_{ji} (t + \Delta t) \cdot
    \left[
        \bm{v}_{j}^{\prime} (t + \Delta t)
        +
        \frac{2\xi}{m_{j}} \bm{r}_{ji} (t + \Delta t)
    \right]
    &&=0
\end{alignat}
と計算される. これより直ちに未定乗数は
\begin{equation}
    \xi
    =
    \frac{\bm{r}_{ji} (t + \Delta t) \cdot \bm{v}_{ji}^{\prime} (t + \Delta t)}
    {\left( \frac{1}{m_{i}} + \frac{1}{m_{j}}\right) d_{ij}^{2}}
\end{equation}
と求まる. 
ここで, $\bm{r}_{ji}^{2} (t + \Delta t) = d_{ij}^{2}$であることを用いた. 

\section{ガウスの最小束縛原理 (ガウス束縛法)}
拘束条件付きの運動方程式は
\begin{align}
    m \ddot{\bm{r}}
    =
    \bm{F} (\bm{r}) + \bm{F}_{\mathrm{c}}
    \label{Eq:EoM-constrain}
\end{align}
のように書かれる.
右辺第一項目はポテンシャルに由来する力, 第二項目は拘束条件に由来して生じる拘束力である.
拘束力は, 粒子の受ける力が拘束条件によって規定される拘束面に沿うようにポテンシャルに由来する力$\bm{F}$を修正する.

\textbf{ガウスの最小束縛原理}では拘束力が最小となるように選ぶ.
そのためには, 拘束力が拘束面に垂直になるように選ぶ必要がある.
位置$\bm{r}$において拘束面に垂直な単位ベクトルを$\bm{n}(\bm{r})$とすると, ポテンシャルに由来する力$\bm{F}(\bm{r})$を拘束面に垂直な方向に写像すれば良いので
\begin{equation}
    \bm{F}_{\mathrm{c}}
    =
    - [\bm{n} (\bm{r}) \cdot \bm{F}(\bm{r})] \bm{n}(\bm{r})
\end{equation}
とかける. よって粒子の運動は力
\begin{equation}
    \bm{F}^{\prime} = \bm{F}(\bm{r}) - [\bm{n} (\bm{r}) \cdot \bm{F}(\bm{r})] \bm{n}(\bm{r})
\end{equation}
にしたがって動かせば良い.

\subsection{ホロノミックな拘束の場合}
ホロノミックな拘束の場合のガウスの最小束縛原理を見ていく.
ホロノミックな拘束条件は
\begin{equation}
    \sigma (\bm{r}) = 0
\end{equation}
のように質点の座標の間に成り立つ等式で書かれるような条件であった.
時間について2回微分をすると,
\begin{align}
    &
    \nabla \sigma \cdot \dot{\bm{r}} = 0
    \\
    &
    \nabla \sigma \cdot \ddot{\bm{r}} +
    \nabla \nabla \sigma \cdot\cdot \dot{\bm{r}} \dot{\bm{r}} = 0
    \label{Eq:constrain-holonomic-dtdt}
\end{align}
を得る. 式(\ref{Eq:constrain-holonomic-dtdt})に拘束条件付き運動方程式(\ref{Eq:EoM-constrain})を代入すると,
\begin{equation}
    \nabla \sigma \cdot
    \left(
        \frac{\bm{F}(\bm{r})}{m}
        +
        \frac{\bm{F}_{\mathrm{c}}}{m}
    \right)
    +
    \nabla \nabla \sigma \cdot\cdot \dot{\bm{r}} \dot{\bm{r}}
    =
    0
\end{equation}
となる. これを整理すると,
\begin{equation}
    \nabla\sigma \cdot \bm{F}_{\mathrm{c}}
    =
    -
    \nabla\sigma \cdot \bm{F}(\bm{r})
    - m
    \nabla \nabla \sigma \cdot\cdot \dot{\bm{r}} \dot{\bm{r}}
\end{equation}
となる.
ガウスの最小束縛原理では, 拘束力を最小にするには拘束力が拘束面に垂直になるように選ぶ必要があった.
$\nabla \sigma(\bm{r})$は位置$\bm{r}$における拘束面に直行するベクトルを表す.
拘束力を
\begin{equation}
\bm{F}_{\mathrm{c}} = \lambda \nabla \sigma
\end{equation}
のように選ぶと, 拘束面に垂直するベクトル$\nabla \sigma$と同じ向きを向いていて, ガウスの最小束縛原理の要請を満たす.
$\lambda$について解けば,
\begin{equation}
    \lambda=
    -
    \frac{\nabla\sigma \cdot \bm{F}(\bm{r}) + m
    \nabla \nabla \sigma \cdot\cdot \dot{\bm{r}} \dot{\bm{r}}}{|\nabla \sigma|^{2}}
\end{equation}
を得る. したがって, 拘束条件付きの運動方程式
\begin{equation}
    m \ddot{\bm{r}}
    =
    \bm{F}(\bm{r})
    -
    \frac{\nabla\sigma \cdot \bm{F}(\bm{r}) + m
    \nabla \nabla \sigma \cdot\cdot \dot{\bm{r}} \dot{\bm{r}}}{|\nabla \sigma|^{2}}
    \nabla \sigma
\end{equation}
を得る. この運動方程式をガウスの運動方程式という.

\subsection{半ホロノミックな拘束の場合}
半ホロノミックな拘束の場合のガウスの最小束縛原理を見ていく.
半ホロノミックな拘束条件は
\begin{equation}
    \zeta(\bm{r}, \dot{\bm{r}}, t) = 0
\end{equation}
のように, 拘束条件が座標, 速度, 時刻の関数となっている.
時間について微分すると,
\begin{equation}
    \frac{d \zeta(\bm{r}, \dot{\bm{r}}, t)}{dt}
    =
    \frac{\partial \zeta}{\partial \bm{r}}
    \cdot \dot{\bm{r}}
    +
    \frac{\partial \zeta}{\partial \dot{\bm{r}}}
    \cdot \ddot{\bm{r}}
    +
    \frac{\partial \zeta}{\partial t}
    =0
\end{equation}
となる.
拘束条件付き運動方程式(\ref{Eq:EoM-constrain})を代入すると,
\begin{equation}
    \frac{\partial \zeta}{\partial \dot{\bm{r}}}
    \cdot
    \left(
        \frac{\bm{F}(\bm{r})}{m}
        +
        \frac{\bm{F}_{\mathrm{c}}}{m}
    \right)
    =
    -
    \frac{\partial \zeta}{\partial \bm{r}}
    \cdot
    \dot{\bm{r}}
    -
    \frac{\partial \zeta}{\partial t}
\end{equation}
これを整理すると,
\begin{equation}
    \frac{\partial \zeta}{\partial \dot{\bm{r}}}
    \cdot
    \bm{F}_{\mathrm{c}}
    =
    -
    \frac{\partial \zeta}{\partial \dot{\bm{r}}}
    \cdot
    \bm{F}(\bm{r})
    - m
    \frac{\partial \zeta}{\partial \bm{r}}
    \cdot
    \dot{\bm{r}}
    - m
    \frac{\partial \zeta}{\partial t}
\end{equation}
となる. 
右辺は粒子の座標と速度(運動量)と時刻が決まれば値が決まり, 拘束力$|\bm{F}_{\mathrm{c}}|$の選び方にはよらない.
ガウスの最小束縛原理より, 拘束力が拘束面に垂直になるように決めれば, 拘束力$|\bm{F}_{\mathrm{c}}|$を最小にすることができる.
これはすなわち未定乗数$\lambda$を用いて
\begin{equation}
    \bm{F}_{\mathrm{c}}
    =
    \lambda
    \frac{\partial \zeta}{\partial \dot{\bm{r}}}
    \label{Eq:Select-Fc}
\end{equation}
と選んで, $\lambda$について解けば良いということである.
以下の節では具体的な例として, 温度・圧力を拘束条件として課した場合を議論していく.

\section{ガウス束縛法: 温度制御}

\subsection{温度一定のガウス束縛法}
\subsubsection{運動方程式}

瞬間温度を一定に保つように束縛をかける場合, 束縛条件は
\begin{equation}
    \zeta(\bm{r}, \dot{\bm{r}}, t)
    =
    \frac{m}{2}\dot{\bm{r}}^{2}
    -
    \frac{g}{2} k_{\mathrm{B}} T_{\mathrm{eq}}
\end{equation}
である.
ここで$g$は系の自由度である.
瞬間温度に対する拘束条件を課しているので$g = 3N - 1$となる.
$\dot{\bm{r}}$に関して微分を計算すると,
\begin{equation}
    \frac{\partial \zeta}{\partial \dot{\bm{r}}}
    =
    m \dot{\bm{r}}
    =
    \bm{p}
\end{equation}
を得る.
したがって, 式(\ref{Eq:Select-Fc})が示すように, 束縛力$\bm{F}_{\mathrm{c}}$を運動量$\bm{p}$に比例するように取れば良いことがわかる.
未定乗数$\lambda$を導入すると, 運動方程式は
\begin{alignat}{3}
    \frac{d \bm{r}_{i}}{dt}
    &=
    \frac{\bm{p}_{i}}{m}
    \label{Eq:EoM-Gauss-Constant-Temperature1}
    \\
    \frac{d \bm{p}_{i}}{dt}
    &=
    \bm{F}_{i} - \lambda \bm{p}_{i}
    \label{Eq:EoM-Gauss-Constant-Temperature2}
\end{alignat}
となる.

\subsubsection{未定乗数の決定}
未定乗数$\lambda$は温度一定の束縛条件
\begin{equation}
    \sum_{i=1}^{N}
    \frac{\bm{p}_{i}^{2}}{2m_{i}}
    -
    \frac{g}{2} k_{\mathrm{B}} T_{\mathrm{eq}}
    =
    0
    \label{Eq:Constrain-Temperature}
\end{equation}
を満たすように決めれば良い.
式(\ref{Eq:Constrain-Temperature})の時間微分
\begin{equation}
    \sum_{i=1}^{N}
    \frac{\bm{p}_{i}}{m_{i}} \cdot \dot{\bm{p}_{i}}
    =
    0
\end{equation}
を式(\ref{Eq:EoM-Gauss-Constant-Temperature2})に代入すると,
\begin{equation}
    \sum_{i=1}^{N}
    \frac{\bm{p}_{i}}{m_{i}}
    \cdot
    \left( \bm{F}_{i} - \lambda \bm{p}_{i}\right)
    =
    0
\end{equation}
よって, 未定乗数$\lambda$は
\begin{equation}
    \lambda
    =
    \frac
    {\sum_{i=1}^{N} \frac{\bm{p}_{i}}{m_{i}} \cdot \bm{F}_{i}}
    {\sum_{i=1}^{N} \frac{\bm{p}_{i}^{2}}{m_{i}}}
    =
    \frac
    {\sum_{i=1}^{N} \frac{\bm{p}_{i}}{m_{i}} \cdot \bm{F}_{i}}
    {g k_{\mathrm{B}} T_{\mathrm{eq}}}
    \label{Eq:EoM-Gauss-Constant-Temperature-Lambda}
\end{equation}
となる. 式(\ref{Eq:EoM-Gauss-Constant-Temperature1}), (\ref{Eq:EoM-Gauss-Constant-Temperature2}), (\ref{Eq:EoM-Gauss-Constant-Temperature-Lambda})が温度一定のガウス束縛法の運動方程式である.
なお, 力$\bm{F}_{i}$はポテンシャルエネルギ$U$の座標微分
\begin{equation}
    \bm{F}_{i}
    =
    -
    \frac{\partial U}{\partial \bm{r}_{i}}
\end{equation}
であるので, 式(\ref{Eq:EoM-Gauss-Constant-Temperature-Lambda})の分子は
\begin{equation}
    \sum_{i=1}^{N}
    \frac{\bm{p}_{i}}{m_{i}} \cdot \bm{F}_{i}
    =
    -\sum_{i=1}^{N}
    \dot{\bm{r}}_{i} \cdot
    \frac{\partial U}{\partial \bm{r}_{i}}
    =
    -
    \frac{dU}{dt}
\end{equation}
のようにポテンシャルエネルギーの時間全微分の形に直すことができる.
よって未定乗数$\lambda$は全ポテンシャルエネルギーの時間全微分を用いて
\begin{equation}
    \lambda
    =
    -
    \frac
    {1}{g k_{\mathrm{B}} T_{\mathrm{eq}}}
    \frac{dU}{dt}
    \label{Eq:EoM-Gauss-Constant-Temperature-Lambda2}
\end{equation}
とかける.

\subsection{ガウス束縛法により得られる統計アンサンブル}
位相空間$\bm{\Gamma} = (\bm{r}, \bm{p})$における状態分布関数$f(\bm{\Gamma})$を考える.
状態分布関数$f(\bm{\Gamma})$について連続の式(一般化されたリウヴィル方程式)
\begin{equation}
    \frac{\partial f}{\partial t}
    +
    \frac{\partial}{\partial \bm{\Gamma}}
    \cdot
    \left(
        \dot{\bm{\Gamma}} f
    \right)
    =
    0
    \label{Eq:Generalized-Liouville-Eq}
\end{equation}
が成立する.
式(\ref{Eq:Generalized-Liouville-Eq})の左辺第二項目は
\begin{equation}
    \frac{\partial}{\partial \bm{\Gamma}}
    \cdot
    \left(
        \dot{\bm{\Gamma}} f
    \right)
    =
    \dot{\bm{\Gamma}}
    \cdot
    \frac{\partial f}{\partial \bm{\Gamma}}
    +
    \left(
        \frac{\partial}{\partial \bm{\Gamma}}
        \cdot
        \dot{\bm{\Gamma}}
    \right)
    f
    \label{Eq:Generalized-Liouville-Eq2}
\end{equation}
と展開される.
式(\ref{Eq:Generalized-Liouville-Eq}), (\ref{Eq:Generalized-Liouville-Eq2})を用いれば, 状態分布関数$f(\bm{\Gamma})$の全微分は
\begin{equation}
    \frac{df}{dt}
    =
    \frac{\partial f}{\partial t}
    +
    \dot{\bm{\Gamma}}
    \frac{\partial f}{\partial \bm{\Gamma}}
    =
    -
    \left(
        \frac{\partial}{\partial \bm{\Gamma}}
        \cdot
        \dot{\bm{\Gamma}}
    \right)
    f
    \label{Eq:Gauss-dfdt}
\end{equation}
と計算される. この式の最右辺の()の中は, ガウス束縛法の運動方程式(\ref{Eq:EoM-Gauss-Constant-Temperature1}), (\ref{Eq:EoM-Gauss-Constant-Temperature2})を用いれば以下のように計算される:
\begin{align}
    \frac{\partial}{\partial \bm{\Gamma}}
    \cdot
    \dot{\bm{\Gamma}}
    &=
    \sum_{i=1}^{N}
    \left(
        \frac{\partial}{\partial \bm{p}_{i}} \cdot \dot{\bm{p}}
        +
        \frac{\partial}{\partial \bm{r}_{i}} \cdot \dot{\bm{r}}
    \right)
    \notag \\
    &=
    \sum_{i=1}^{N}
    \left\{
        \frac{\partial}{\partial \bm{p}_{i}} \cdot
        \left(\bm{F}_{i} - \lambda \bm{p}_{i }\right)
        +
        \frac{\partial}{\partial \bm{r}_{i}} \cdot
        \left(\frac{\bm{p}_{i}}{m_{i}}\right)
    \right\}
    \notag \\
    &=
    -3N\lambda
    -
    \sum_{i=1}^{N}
    \bm{p}_{i} \cdot \frac{\partial \lambda}{\partial \bm{p}_{i}}
    \notag \\
    &=
    - (3N - 1) \lambda
    \label{Eq:Gauss-dfdt2}
\end{align}
と計算される. 
なお途中の計算で
\begin{align}
    \frac{\partial}{\partial \bm{p}_{i}} \cdot \bm{F}_{i} = 0,~~~~
    \frac{\partial}{\partial \bm{r}_{i}} \cdot \bm{p}_{i} = 0
    \notag 
\end{align}
であることと, 
\begin{align}
    \sum_{i=1}^{N}
    \bm{p}_{i} \cdot \frac{\partial \lambda}{\partial \bm{p}_{i}}
    &=
    \sum_{i=1}^{N}
    \bm{p}_{i} \cdot \frac{\partial}{\partial \bm{p}_{i}}
    \left(
        \frac
        {\sum_{j=1}^{N} \frac{\bm{p}_{j}}{m_{j}} \cdot \bm{F}_{j}}
        {\sum_{j=1}^{N} \frac{\bm{p}_{j}^{2}}{m_{j}}}
    \right)
    =
    -
    \frac
    {\sum_{i=1}^{N} \frac{\bm{p}_{i}}{m_{i}} \cdot \bm{F}_{i}}
    {\sum_{i=1}^{N} \frac{\bm{p}_{i}^{2}}{m_{i}}}
    +
    2
    \frac
    {
        \left(\sum_{i=1}^{N} \frac{\bm{p}_{i}}{m_{i}} \cdot \bm{F}_{i}\right)
        \left(\sum_{i=1}^{N} \frac{\bm{p}_{i}^{2}}{m_{i}}\right)
    }
    {\left(\sum_{i=1}^{N} \frac{\bm{p}_{i}^{2}}{m_{i}}\right)^{2}}
    \notag \\
    &=
    \lambda - 2 \lambda
    \notag \\
    &=
    - \lambda
    \notag
\end{align}
と計算されることを用いた.
結局, 状態分布関数の全微分式(\ref{Eq:Gauss-dfdt})は, 式(\ref{Eq:EoM-Gauss-Constant-Temperature-Lambda2}), (\ref{Eq:Gauss-dfdt2})を用いることで
\begin{equation}
    \frac{df}{dt}
    =
    -\frac{3N-1}{g}
    \frac{1}{k_{\mathrm{B}}T_{\mathrm{eq}}}
    \frac{dU}{dt} f
\end{equation}
と書き直せる. $g = 3N=1$と選べば
\begin{equation}
    \frac{df}{dt}
    =
    -
    \frac{1}{k_{\mathrm{B}}T_{\mathrm{eq}}}
    \frac{dU}{dt} f
\end{equation}
となる. この微分方程式は簡単に解くことができ,
\begin{equation}
    f(\bm{r}, \bm{p})
    =
    C
    \exp
    \left\{
        - \frac{U(\bm{r})}{k_{\mathrm{B}} T_{\mathrm{eq}}}
    \right\}
\end{equation}
となる. ここで$C$は定数である.
さらに, 今は運動エネルギー一定の束縛が課せられていりことを考慮すれば, 状態分布関数$f(\bm{r}, \bm{p})$は
\begin{equation}
    f(\bm{r}, \bm{p})
    =
    \delta
    \left(
        \sum_{i=1}^{N}
        \frac{\bm{p}_{i}^{2}}{2m_{i}}
        -
        \frac{g}{2} k_{\mathrm{B}}{T_{\mathrm{eq}}}
    \right)
    \exp
    \left\{
        - \frac{U(\bm{r})}{k_{\mathrm{B}} T_{\mathrm{eq}}}
    \right\}
\end{equation}
となる. 
この式からGauss束縛法では座標空間$\bm{r}$ではカノニカルアンサンブルを得られるが, 運動量空間$\bm{p}$は束縛条件によってカノニカルアンサンブルにならないことが直ちに分かる.
しかし, 実際のMDでは座標空間でカノニカルアンサンブルが得られていれば, 運動量の分布は解析的に計算することができるので, 特に問題となることはない.

\subsection{ガウス束縛法と能勢の方法の関係}
\subsubsection{能勢のハミルトニアン(再掲)}
能勢のハミルトニアンは
\begin{equation}
    \mathcal{H}_{\mathrm{N}}
    =
    \sum_{i=1}^{N}
    \frac{\bm{p}_{i}^{\prime}}{2m_{i}s^{2}}
    +
    U(\bm{r}^{\prime})
    +
    \frac{P_{s}^{2}}{2Q}
    +
    g k_{\mathrm{B}} T_{\mathrm{eq}} \log s
    \label{Eq:Gauss-NoseHamiltonian}
\end{equation}
であった. 仮想時間$t^{\prime}$での正準方程式は
\begin{alignat}{4}
    \frac{d \bm{r}_{i}^{\prime}} {dt^{\prime}}
    &=&&
    \frac{\partial \mathcal{H}_{\mathrm{N}}}{\partial \bm{p}_{i}^{\prime}}
    &&=
    \frac{\bm{p}_{i}^{\prime}}{m_{i}s^{2}}
    \\
    \frac{d \bm{p}_{i}^{\prime}} {dt^{\prime}}
    &=-&&
    \frac{\partial \mathcal{H}_{\mathrm{N}}}{\partial \bm{r}_{i}^{\prime}}
    &&=
    \bm{F}_{i}
    \\
    \frac{d s} {dt^{\prime}}
    &= &&
    \frac{\partial \mathcal{H}_{\mathrm{N}}}{\partial P_{s}}
    &&=
    \frac{P_{s}}{Q}
    \\
    \frac{d P_{s}} {dt^{\prime}}
    &= -&&
    \frac{\partial \mathcal{H}_{\mathrm{N}}}{\partial s}
    &&=
    \frac{1}{s}
    \left(
        \sum_{i=1}^{N}
        \frac{\bm{p}_{i}^{\prime2}}{m_{i}s^{2}}
        -
        g k_{\mathrm{B}} T_{\mathrm{eq}}
    \right)
\end{alignat}
と求まる.

\subsubsection{能勢の運動方程式からガウス束縛法の運動方程式を導出する}
この節では, 能勢のハミルトニアンに対してある拘束条件を課して運動方程式を導いた時に, ガウス束縛法が導出されることを見ていく.
具体的には能勢の熱浴に関する変数に対して
\begin{alignat}{4}
    \frac{\partial \mathcal{H}_{\mathrm{N}}}{\partial P_{s}}
    &=
    \frac{P_{s}}{Q}
    \equiv
    0
    \label{Eq:NoseHamiltonian-Constrain1}
    \\
    \frac{\partial \mathcal{H}_{\mathrm{N}}}{\partial s}
    &=
    -
    \frac{1}{s}
    \left(
        \sum_{i=1}^{N}
        \frac{\bm{p}_{i}^{\prime2}}{m_{i}s^{2}}
        -
        g k_{\mathrm{B}} T_{\mathrm{eq}}
    \right)
    \equiv
    0
    \label{Eq:NoseHamiltonian-Constrain2}
\end{alignat}
のような拘束条件を課す.
最初の拘束条件から, 能勢のハミルトニアン(\ref{Eq:Gauss-NoseHamiltonian})の第三項目が常に0になることがわかる.
また二つ目の束縛条件から, $s$はもはや独立変数ではなくて$\bm{r}_{i}^{\prime}$と$\bm{p}_{i}^{\prime}$に依存する. すなわち$s = s(\bm{r}_{i}^{\prime}, \bm{p}_{i}^{\prime})$となる.
これらの束縛条件のもとで正準方程式を導く際には, $s$が独立変数でないので$s$を介しての$\bm{r}_{i}^{\prime}$に関する微分や$\bm{p}_{i}^{\prime}$に関する微分を考慮する必要がある.
(ただし, $\partial \mathcal{H}_{\mathrm{N}}/\partial s =0$なので, 結局これらの項は0になる). 導入した拘束条件の下では以下の運動方程式が得られる:

\begin{alignat}{4}
    \frac{d \bm{r}_{i}^{\prime}}{dt^{\prime}}
    &= &&
    \frac{\partial \mathcal{H}_{\mathrm{N}}}{\partial \bm{p}_{i}^{\prime}}
    +
    \frac{\partial \mathcal{H}_{\mathrm{N}}}{\partial s}
    \frac{\partial s}{\partial \bm{p}_{i}^{\prime}}
    = &&
    \frac{\partial \mathcal{H}_{\mathrm{N}}}{\partial \bm{p}_{i}^{\prime}}
    =
    \frac{\bm{p}_{i}^{\prime}}{m_{i}s^{2}}
    \label{Eq:EoMs-Nose-Constrain1}
    \\
    \frac{d \bm{p}_{i}^{\prime}}{dt^{\prime}}
    &= -&&
    \frac{\partial \mathcal{H}_{\mathrm{N}}}{\partial \bm{r}_{i}^{\prime}}
    -
    \frac{\partial \mathcal{H}_{\mathrm{N}}}{\partial s}
    \frac{\partial s}{\partial \bm{r}_{i}^{\prime}}
    =-&&
    \frac{\partial \mathcal{H}_{\mathrm{N}}}{\partial \bm{r}_{i}^{\prime}}
    =
    \frac{\partial U}{\partial \bm{r}_{i}^{\prime}}
    \label{Eq:EoMs-Nose-Constrain2}
\end{alignat}
ここで, 熱浴の自由度$s$は束縛条件から
\begin{equation}
    s
    =
    \left\{
        \frac{1}{g k_{\mathrm{B}} T_{\mathrm{eq}}}
        \left(
            \sum_{i=1}^{N}
            \frac{\bm{p}_{i}^{2}}{m_{i}}
        \right)
    \right\}^{\frac{1}{2}}
    \label{Eq:Gauss-Nose-Constrain-s}
\end{equation}
と書くことができる.

続いて, 仮想時間での運動方程式(\ref{Eq:EoMs-Nose-Constrain1}), (\ref{Eq:EoMs-Nose-Constrain2})を実時間で書き直すと,
\begin{alignat}{6}
    \frac{d \bm{r}_{i}}{dt}
    &=
    s
    \frac{d \bm{r}_{i}}{dt^{\prime}}
    &&=&&
    \frac{\bm{p}_{i}^{\prime}}{m_{i}s}
    =
    \frac{\bm{p}_{i}}{m_{i}}
    \label{Eq:EoMs-Nose-Constrain1-t}
    \\
    \frac{d \bm{p}_{i}}{dt}
    &=
    s
    \frac{d}{dt^{\prime}}
    \left(
        \frac{\bm{p}_{i}^{\prime}}{s}
    \right)
    &&=-&&
    \frac{\partial U}{\partial \bm{r}_{i}^{\prime}}
    -
    \frac{1}{s}
    \frac{ds}{dt^{\prime}} \bm{p}_{i}^{\prime}
    =
    -
    \frac{\partial U}{\partial \bm{r}_{i}}
    -
    \frac{ds}{dt^{\prime}} \bm{p}_{i}
    \label{Eq:EoMs-Nose-Constrain2-t}
\end{alignat}
を得る. さらに拘束条件式(\ref{Eq:NoseHamiltonian-Constrain2})を変形して$t^{\prime}$に関して微分すると,
\begin{equation}
    \sum_{i=1}^{N}
    \frac{\bm{p}_{i}^{\prime}}{m_{i}}
    \frac{d \bm{p}_{i}^{\prime}}{dt^{\prime}}
    =
    g k_{\mathrm{B}} T_{\mathrm{eq}} s \frac{ds}{dt^{\prime}}
\end{equation}
であるので,
\begin{align}
    \frac{ds}{dt^{\prime}}
    &=
    \frac{1}{g k_{\mathrm{B}} T_{\mathrm{eq}}}
    \frac{1}{s}
    \sum_{i=1}^{N}
    \frac{\bm{p}_{i}^{\prime}}{m_{i}}
    \frac{d \bm{p}_{i}^{\prime}}{dt^{\prime}}
    \notag \\
    &=
    \frac{1}{g k_{\mathrm{B}} T_{\mathrm{eq}}}
    \left\{
        \sum_{i=1}^{N}
        \frac{\bm{p}_{i}^{\prime}}{m_{i}s} \cdot
        \left(
            - \frac{\partial U}{\partial \bm{r}_{i}^{\prime}}
        \right)
    \right\}
    \notag \\
    &=
    -
    \frac{1}{g k_{\mathrm{B}} T_{\mathrm{eq}}}
    \left(
        \sum_{i=1}^{N}
        \frac{\partial U}{\partial \bm{r}_{i}^{\prime}}
        \cdot
        \frac{\bm{p}_{i}}{m_{i}}
    \right)
    \notag \\
    &=
    -
    \frac{1}{g k_{\mathrm{B}} T_{\mathrm{eq}}}
    \left(
        \sum_{i=1}^{N}
        \frac{\partial U}{\partial \bm{r}_{i}}
        \cdot
        \frac{d \bm{r}_{i}}{dt}
    \right)
    \notag \\
    &=
    -
    \frac{1}{g k_{\mathrm{B}} T_{\mathrm{eq}}}
    \frac{dU}{dt}
    \notag
\end{align}
と計算することができる.
ガウス束縛法で導出した未定乗数(\ref{Eq:EoM-Gauss-Constant-Temperature-Lambda2})との比較から
\begin{equation}
    \frac{ds}{dt^{\prime}} = \lambda
\end{equation}
と置くことができる. 
よって実時間における拘束条件を課した能勢の運動方程式(\ref{Eq:EoMs-Nose-Constrain1-t}), (\ref{Eq:EoMs-Nose-Constrain2-t})は
\begin{alignat}{3}
    \frac{d \bm{r}_{i}}{dt}
    &=
    \frac{\bm{p}_{i}}{m}
    \\
    \frac{d \bm{p}_{i}}{dt}
    &=
    \bm{F}_{i} - \lambda \bm{p}_{i}
\end{alignat}
と書くことができる.
すなわち, 温度一定のガウス束縛法は能勢の方法に運動エネルギーの束縛を課したものと一致することが確認できた.

\subsubsection{拘束条件付き能勢の運動方程式が生成するアンサンブル}
前の節では, 能勢の方法に運動エネルギーの束縛を課すと温度一定のガウス束縛法に一致することを見た.
ここでは, 拘束条件付きの能勢の運動方程式がガウス束縛法と同様のアンサンブルを生成することを確認する \cite{Nose1991}.
まず初めに, 運動方程式(\ref{Eq:EoMs-Nose-Constrain1}), (\ref{Eq:EoMs-Nose-Constrain1})にしたがって時間発展させた場合でもハミルトニアンは保存することを確認する.
ハミルトニアンの時間微分を具体的に計算すると,
\begin{align}
    \frac{d \mathcal{H}_{\mathrm{N}}}{dt^{\prime}}
    =
    \sum_{i=1}^{N}
    \left(
        \frac{\partial \mathcal{H}_{\mathrm{N}}}{\partial \bm{p}_{i}^{\prime}}
        \frac{d \bm{p}_{i}^{\prime}}{dt^{\prime}}
        +
        \frac{\partial \mathcal{H}_{\mathrm{N}}}{\partial \bm{r}_{i}^{\prime}}
        \frac{d \bm{r}_{i}^{\prime}}{dt^{\prime}}
    \right)
    +
    \frac{\partial \mathcal{H}_{\mathrm{N}}}{\partial P_{s}}
    \frac{d P_{s}}{dt^{\prime}}
    +
    \frac{\partial \mathcal{H}_{\mathrm{N}}}{\partial s}
    \frac{d s}{dt^{\prime}}
\end{align}
となる. 拘束条件式(\ref{Eq:NoseHamiltonian-Constrain1}), (\ref{Eq:NoseHamiltonian-Constrain2})より右辺の第3項目と第4項目はゼロになる.
さらに右辺の第1項目は
\begin{equation}
    \sum_{i=1}^{N}
    \left(
        \frac{\partial \mathcal{H}_{\mathrm{N}}}{\partial \bm{p}_{i}^{\prime}}
        \frac{d \bm{p}_{i}^{\prime}}{dt^{\prime}}
        +
        \frac{\partial \mathcal{H}_{\mathrm{N}}}{\partial \bm{r}_{i}^{\prime}}
        \frac{d \bm{r}_{i}^{\prime}}{dt^{\prime}}
    \right)
    =
    \sum_{i=1}^{N}
    \left\{
        \left(
            \frac{\bm{p}_{i}^{\prime}}{m_{i}s^{2}}
        \right)
        \left(
            -\frac{\partial U}{\partial \bm{r}_{i}^{\prime}}
        \right)
        +
        \left(
            \frac{\partial U}{\partial \bm{r}_{i}^{\prime}}
        \right)
        \left(
            \frac{\bm{p}_{i}^{\prime}}{m_{i}s^{2}}
        \right)
    \right\}
    =
    0
\end{equation}
である. 以上からハミルトニアンの時間微分がゼロとなり, 保存量であることが確認できた.

続いて分配関数を考える. 拡張系における分配関数は以下の通りとなる:
\begin{equation}
    Z
    =
    \int_{0}^{\infty}ds
    \int d\bm{r}^{\prime}
    \int d\bm{p}^{\prime}
    \delta
    \left\{
        \mathcal{H}_{0}(\bm{r}^{\prime}, \bm{p}^{\prime}/s)
        +
        g k_{\mathrm{B}} T_{\mathrm{eq}} \log s
        -
        E
    \right\}
    \delta
    \left\{s - s_{0}\right\}
\end{equation}
\begin{equation}
    s_{0} \equiv
    \left(
        \frac
        {\sum_{i=1}^{N} \bm{p}_{i}^{2} / m_{i}}
        {g k_{\mathrm{B}} T_{\mathrm{eq}}}
    \right)^{\frac{1}{2}}
\end{equation}
なおここでは, 熱浴の自由度$s$について式(\ref{Eq:Gauss-Nose-Constrain-s})の拘束条件が課されていることに注意する必要がある.
$\delta$関数の恒等式
\begin{equation}
    \delta(f(s))
    =
    \frac{\delta (s - s_{0})}{|f^{\prime}(s)|}
    ~~~~
    \mathrm{但し}~ f(s_{0}) = 0
\end{equation}
を変形した,
\begin{equation}
    \delta(s - s_{0})
    =
    |f^{\prime}(s)| \delta(f(s))
\end{equation}
を用いる. $f(s_{0}) = 0$となるように
\begin{equation}
    f(s)
    \equiv
    \frac{g k_{\mathrm{B}} T_{\mathrm{eq}}}{2}
    -
    \sum_{i=1}^{N}
    \frac{\bm{p}_{i}^{\prime 2}}{2 m_{i} s^{2}}
\end{equation}
を定義すれば
\begin{align}
    \frac{d f(s)}{ds}
    &=
    \frac{d}{ds}
    \left(
        \frac{g k_{\mathrm{B}} T_{\mathrm{eq}}}{2}
        -
        \sum_{i=1}^{N}
        \frac{\bm{p}_{i}^{\prime 2}}{2 m_{i} s^{2}}
    \right)
    =
    \frac{d}{ds}
    \left(
        - \sum_{i=1}^{N}
        \frac{\bm{p}_{i}^{2}}{2m_{i}} s^{-2}
    \right)
    \notag \\
    &=
    \sum_{i=1}^{N}
    \frac{\bm{p}_{i}^{\prime 2}}{m_{i}s^{3}}
    =
    \sum_{i=1}^{N}
    \frac{1}{s}
    \frac{\bm{p}_{i}^{\prime 2}}{m_{i}s^{2}}
    \notag \\
    &=
    \frac{g k_{\mathrm{B}} T_{\mathrm{eq}}}{s}
\end{align}
である. 得られた式を分配関数の中に入れると
\begin{align}
    Z
    =
    \int_{0}^{\infty}ds
    \int d\bm{r}^{\prime}
    \int d\bm{p}^{\prime}
    &
    \delta
    \left\{
        \mathcal{H}_{0}(\bm{r}^{\prime}, \bm{p}^{\prime}/s)
        +
        g k_{\mathrm{B}} T_{\mathrm{eq}} \log s
        -
        E
    \right\}
    \notag \\
    \times
    &
    \frac{g k_{\mathrm{B}} T_{\mathrm{eq}}}{s}
    \delta
    \left\{
        \frac{g k_{\mathrm{B}} T_{\mathrm{eq}}}{2}
        -
        \sum_{i=1}^{N}
        \frac{\bm{p}_{i}^{\prime 2}}{2 m_{i} s^{2}}
    \right\}
\end{align}
と書き直せる.
続いて, 仮想時間から実時間への変数変換$\bm{r}_{i}^{\prime} = \bm{r}_{i}$および
$\bm{p}_{i}^{\prime} = s \bm{p}_{i}$を行う.
$\bm{r}_{i}^{\prime}$, $\bm{p}_{i}^{\prime}$の微分は
\begin{equation}
    d \bm{r}_{i}^{\prime} d \bm{p}_{i}^{\prime}
    =
    s d\bm{r}_{i} d \bm{p}_{i}
\end{equation}
であるので, 分配関数は
\begin{align}
    Z
    = &
    \int d\bm{p}~
    \delta
    \left(
        \sum_{i=1}^{N} \frac{\bm{p}_{i}^{2}}{2m_{i}}
        -
        \frac{g k_{\mathrm{B}} T_{\mathrm{eq}}}{2}
    \right)
    \notag \\
    &\times
    \int d\bm{r}
    \int_{0}^{\infty} ds~ s^{3N-1}
    g k_{\mathrm{B}} T_{\mathrm{eq}}
    \delta
    \left\{
        \mathcal{H}_{0}(\bm{r}, \bm{p})
        +
        g k_{\mathrm{B}} T_{\mathrm{eq}} \log s
        -
        E
    \right\}
    \notag \\
    = &
    \int d\bm{p}~
    \delta
    \left(
        \sum_{i=1}^{N} \frac{\bm{p}_{i}^{2}}{2m_{i}}
        -
        \frac{g k_{\mathrm{B}} T_{\mathrm{eq}}}{2}
    \right)
    \notag \\
    &\times
    \int d\bm{r}
    \int_{0}^{\infty} ds~ s^{3N-1}
    g k_{\mathrm{B}} T_{\mathrm{eq}}
    \frac
    {
        \delta
        \left[s - \exp\left\{(E-\mathcal{H}_{0})/g k_{\mathrm{B}} T_{\mathrm{eq}} \right\}\right]
    }
    {
        g k_{\mathrm{B}} T_{\mathrm{eq}} / s
    }
    \notag \\
    = &
    \int d\bm{p}~
    \delta
    \left(
        \sum_{i=1}^{N} \frac{\bm{p}_{i}^{2}}{2m_{i}}
        -
        \frac{g k_{\mathrm{B}} T_{\mathrm{eq}}}{2}
    \right)
    \notag \\
    &\times
    \int d\bm{r}
    \exp
    \left[
        -\frac{3N}{g k_{\mathrm{B}} T_{\mathrm{eq}}}
        \left\{
            \frac{g k_{\mathrm{B}} T_{\mathrm{eq}}}{2}
            +
            U(\bm{r})
            -
            E
        \right\}
    \right]
\end{align}
となる. 最後の変形で
\begin{equation}
    \mathcal{H}_{0}
    =
    \sum_{i=1}^{N}
    \frac{\bm{p}_{i}^{\prime 2}}{2 m_{i} s^{2}}
    +
    U(\bm{r}^{\prime})
    =
    \sum_{i=1}^{N}
    \frac{\bm{p}_{i}^{2}}{2m_{i}}
    +
    U(\bm{r})
    \notag
\end{equation}
であり, $s$の拘束条件から導かれる恒等式
$\sum_{i=1}^{N} \bm{p}_{i}^{2}/ 2m_{i} = g k_{\mathrm{B}} T_{\mathrm{eq}}$を代入すると
\begin{equation}
    \mathcal{H}_{0} = \frac{g k_{\mathrm{B}} T_{\mathrm{eq}}}{2} + U(\bm{r})
    \notag
\end{equation}
となることを用いた.
以上の計算により, $g = 3N$と選ぶと
\begin{equation}
    f(\bm{r}, \bm{p})
    =
    \delta
    \left(
        \sum_{i=1}^{N}
        \frac{\bm{p}_{i}^{2}}{2m_{i}}
        -
        \frac{g}{2} k_{\mathrm{B}} T_{\mathrm{eq}}
    \right)
    \exp
    \left[
        - \frac{U(\bm{r})}{k_{\mathrm{B}} T_{\mathrm{eq}}}
    \right]
\end{equation}
の分布関数に従っていることがわかる.
これより, 仮想時間$t^{\prime}$でサンプルする場合には$g = 3N$とすれば, 座標空間$\bm{r}$についてカノニカルアンサンブルが得られることがわかる.
また, 能勢の方法の時に議論したときと同様に実時間$t$でサンプルする場合には$g = 3N-1$とすることでカノニカルアンサンブルが得られる.
つまり, 実時間$t$でサンプルする場合でも仮想時間$t^{\prime}$でサンプルする場合でも, 元々の能勢の方法と比較して自由度$g$の値は1少ない.
これは, ガウスの束縛法では運動エネルギーに束縛を課しており自由度が1少なくなっているためである.

\subsection{時間発展演算子によるアルゴリズム}
温度一定のガウス束縛法の運動方程式は
\begin{alignat}{5}
    \frac{d \bm{r}_{i}}{dt}
    &=&&
    \frac{\bm{p}_{i}}{m_{i}}
    \\
    \frac{d \bm{p}_{i}}{dt}
    &=-&&
    \frac{\partial U}{\partial \bm{r}_{i}}
    -
    \lambda \bm{p}_{i}
    \equiv
    \bm{F}_{i} + \lambda^{\prime} \bm{p}_{i}
\end{alignat}
である. 演算子$D$を
\begin{eqnarray}
    D \equiv
    \frac{\bm{p}_{i}}{m_{i}} \frac{\partial}{\partial \bm{r}_{i}}
    +
    (\bm{F}_{i} + \lambda^{\prime} \bm{p}_{i})
    \frac{\partial}{\partial \bm{p}_{i}}
\end{eqnarray}
のように定義すると時間発展演算子は
\begin{align}
    e^{D \Delta t}
    =
    \exp
    \left[
        \left\{
            \frac{\bm{p}_{i}}{m_{i}}
            \frac{\partial}{\partial \bm{r}_{i}}
            +
            \left(
                \bm{F}_{i} + \lambda^{\prime} \bm{p}_{i}
            \right)
            \frac{\partial}{\partial \bm{p}_{i}}
        \right\}
        \Delta t
    \right]
\end{align}
とかける. 鈴木・トロッター展開により
\begin{align}
    e^{D \Delta t}
    \simeq
    \exp
    \left[
        \frac{\Delta t}{2}
        \left(
            \bm{F}_{i} + \lambda^{\prime} \bm{p}_{i}
        \right)
        \frac{\partial}{\partial \bm{p}_{i}}
    \right]
    \exp
    \left[
        \frac{\bm{p}_{i}}{m_{i}}
        \frac{\partial}{\partial \bm{r}_{i}}
    \right]
    \exp
    \left[
        \frac{\Delta t}{2}
        \left(
            \bm{F}_{i} + \lambda^{\prime} \bm{p}_{i}
        \right)
        \frac{\partial}{\partial \bm{p}_{i}}
    \right]
\end{align}
のように近似することができる.
演算子$\exp\left[\frac{\Delta t}{2}\left(\bm{F}_{i} + \lambda^{\prime} \bm{p}_{i}\right)\frac{\partial}{\partial \bm{p}_{i}}\right]$による運動量$\bm{p}_{i}$の時間変化は, 演算子の定義により
\begin{equation}
    \frac{d \bm{p}_{i}}{dt}
    =
    \left(
        \bm{F}_{i} + \lambda^{\prime} \bm{p}_{i}
    \right)
    \frac{\partial}{\partial \bm{p}_{i}} \bm{p}_{i}
    =
    \bm{F}_{i} + \lambda^{\prime} \bm{p}_{i}
\end{equation}
を解く必要がある. 
F. Zhang \cite{Zhang1997}らの論文にしたがって微分方程式を解くと厳密な解析解
\begin{equation}
    \bm{p}_{i}(t)
    =
    \frac{1 - \gamma}{\beta - \gamma / \beta}
    \left\{
        \bm{p}_{i}(0) + \bm{F}_{i}(0)
        \frac{1 + \gamma - \beta - \gamma/\beta}{(1 - \gamma)\alpha}
    \right\}
\end{equation}
を得ることができる. ここで
\begin{align}
    \alpha &=
    \sqrt
    {
        \frac
        {\sum_{i=1}^{N} \bm{F}_{i}^{2}(0) / m_{i}}
        {\sum_{i=1}^{N} \bm{p}_{i}^{2}(0) / m_{i}}
    }
    \\
    \beta &=
    \exp[-\alpha t]
    \\
    \gamma &=
    \frac{\lambda^{\prime}(0) - \alpha}{\lambda^{\prime}(0) + \alpha}
\end{align}
である. 以上を用いることで時間発展アルゴリズムを構築することができる.


% \section{ガウス束縛法: 温度・圧力制御}

\bibliographystyle{junsrt}
\bibliography{constrain-dynamics}
\input{../include/end}
